/*!
 * PSPDFKit for Node.js 0.0.5 (https://pspdfkit.com/nodejs)
 *
 * Copyright (c) 2024 PSPDFKit GmbH. All rights reserved.
 *
 * THIS SOURCE CODE AND ANY ACCOMPANYING DOCUMENTATION ARE PROTECTED BY INTERNATIONAL COPYRIGHT LAW
 * AND MAY NOT BE RESOLD OR REDISTRIBUTED. USAGE IS BOUND TO THE PSPDFKIT LICENSE AGREEMENT.
 * UNAUTHORIZED REPRODUCTION OR DISTRIBUTION IS SUBJECT TO CIVIL AND CRIMINAL PENALTIES.
 * This notice may not be removed from this file.
 *
 * PSPDFKit uses several open source third-party components: https://pspdfkit.com/acknowledgements/nodejs/
 */
let e,t;let r="string"==typeof globalThis.process?.versions?.node,o="object"==typeof window&&"Deno"in window||"object"==typeof self&&"Deno"in self;export async function initialize(){if(r){let{createRequire:t}=await import("module");e=t(import.meta.url)}else if(o){let e=new URL("./resources/list.json",import.meta.url),r=await globalThis.fetch(e).then(e=>e.json()),o=await Promise.all(r.map(e=>{let t=new URL(`./resources/${e}`,import.meta.url);return globalThis.fetch(t).then(async e=>{if(e.ok)return e.arrayBuffer()}).then(t=>({buffer:t,filename:e})).catch(()=>({buffer:void 0,filename:e}))}));t=o.reduce((e,{filename:t,buffer:r})=>(e[`${globalThis.gdPicture.baseUrl}/resources/${decodeURI(t)}`]=r,e),{})}}export function fetchResource(e,t){fetch(`${globalThis.gdPicture.baseUrl}/resources/${e}`,t)}export function fetch(i,l){try{if(r){let t=e("node:fs"),r=e("node:path"),o=t.readFileSync(r.normalize(i));globalThis.gdPicture.module.FS.writeFile(l,new Uint8Array(o))}else if(o)globalThis.gdPicture.module.FS.writeFile(l,new Uint8Array(t[i]));else{let e=new XMLHttpRequest;e.open("GET",i,!1),e.overrideMimeType("text/plain; charset=x-user-defined"),e.send(),200===e.status?globalThis.gdPicture.module.FS.writeFile(l,function(e){let t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0,o=e.length;t<o;t++)r[t]=e.charCodeAt(t);return r}(e.response)):console.error(`Could not retrieve resource. Status: ${e.status}`)}}catch(e){console.error(`Could not retrieve resource. Exception: ${e}`)}}